# 保姆级从零到一手把手教你造一个企业级微前端框架

## 前言

微前端是目前比较热门的一种技术架构，挺多读者想了解其中的原理。为了讲清楚原理，我会带着大家从零开始实现一个微前端框架，其中包含了以下功能：

- 如何进行路由劫持
- 如何渲染子应用
- 如何实现 JS 沙箱及样式隔离
- 提升体验性的功能

另外在实现的过程中，笔者还会聊聊目前有哪些技术方案可以去实现微前端以及做以上功能的时候有哪些实现方式。

这里是本次文章的最终产出物仓库地址：[toy-micro](https://github.com/KieSun/toy-micro)。

## 微前端实现方案

微前端的实现方案有挺多，比如说：

1. [qiankun](https://github.com/umijs/qiankun)，自己实现 JS 及样式隔离
2. [icestark](https://github.com/ice-lab/icestark)，iframe 方案，浏览器原生隔离，但存在一些问题
3. [emp](https://github.com/efoxTeam/emp)，Webpack 5 Module Federation（联邦模块）方案
4. WebComponent 等方案

但是这么多实现方案解决的场景问题还是分为两类：

- 单实例：当前页面只存在一个子应用，一般使用 qiankun 就行
- 多实例：当前页面存在多个子应用，可以使用浏览器原生隔离方案，比如 iframe 或者 WebComponent 这些

当然了，并不是说单实例只能用 qiankun，浏览器原生隔离方案也是可行的，只要你接受它们带来的不足就行：

> iframe 最大的特性就是提供了浏览器原生的硬隔离方案，不论是样式隔离、js 隔离这类问题统统都能被完美解决。但他的最大问题也在于他的隔离性无法被突破，导致应用间上下文无法被共享，随之带来的开发体验、产品体验的问题。

上述内容摘自[Why Not Iframe](https://www.yuque.com/kuitos/gky7yw/gesexv)。

本文的实现方案和 qiankun 一致，但是其中涉及到的功能及原理方面的东西都是通用的，你换个实现方案也需要这些。

## 技术架构图

